"use strict";(self.webpackChunkstlite=self.webpackChunkstlite||[]).push([[3808],{93808:(e,t,i)=>{i.r(t),i.d(t,{default:()=>G});var o=i(30969),s=i(46008),n=i(98441),r=i(15888),a=i.n(r),l=i(16868),h=i(3077),d=i(33070),c=i(21283),p=i(19016),m=i(34708),u=i(12127),g=i(72620),x=i(99019),w=i(81507),b=i(93578),y=i(61400),S=i(82919),v=i(98862),f=i(36599),k=i(2313),j=i(47814),T=i.n(j),C=i(13524),z=i(65710),E=i(91439),F=i(24760),V=i(64756),Z=i(35354),I=i(37574);const O=e=>{let{error:t,width:i,deltaType:o}=e;return t instanceof D?(0,I.jsx)(Z.Z,{width:i,name:"No Mapbox token provided",message:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("p",{children:["To use ",(0,I.jsxs)("code",{children:["st.",o]})," or ",(0,I.jsx)("code",{children:"st.map"})," you need to set up a Mapbox access token."]}),(0,I.jsxs)("p",{children:["To get a token, create an account at"," ",(0,I.jsx)("a",{href:"https://mapbox.com",children:"https://mapbox.com"}),". It's free for moderate usage levels!"]}),(0,I.jsxs)("p",{children:["Once you have a token, just set it using the Streamlit config option ",(0,I.jsx)("code",{children:"mapbox.token"})," and don't forget to restart your Streamlit server at this point if it's still running, then reload this tab."]}),(0,I.jsxs)("p",{children:["See"," ",(0,I.jsx)("a",{href:"https://docs.streamlit.io/develop/api-reference/configuration/config.toml",children:"our documentation"})," ","for more info on how to set config options."]})]})}):t instanceof M?(0,I.jsx)(Z.Z,{width:i,name:"Error fetching Streamlit Mapbox token",message:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("p",{children:"This app requires an internet connection."}),(0,I.jsx)("p",{children:"Please check your connection and try again."}),(0,I.jsxs)("p",{children:["If you think this is a bug, please file bug report"," ",(0,I.jsx)("a",{href:"https://github.com/streamlit/streamlit/issues/new/choose",children:"here"}),"."]})]})}):(0,I.jsx)(Z.Z,{width:i,name:"Error fetching Streamlit Mapbox token",message:t.message})};class D extends Error{}class M extends Error{}const P="https://data.streamlit.io/tokens.json",J="mapbox",W=e=>t=>{class i extends o.PureComponent{constructor(i){super(i),this.context=void 0,this.initMapboxToken=async()=>{try{const e=await C.Z.get(P),{[J]:t}=e.data;if(!t)throw new Error(`Missing token ${J}`);this.setState({mapboxToken:t,isFetching:!1})}catch(e){const t=(0,z.b)(e);throw this.setState({mapboxTokenError:t,isFetching:!1}),new M(`${t.message} (${P})`)}},this.render=()=>{const{mapboxToken:i,mapboxTokenError:o,isFetching:s}=this.state,{width:n}=this.props;return o?(0,I.jsx)(O,{width:n,error:o,deltaType:e}):s?(0,I.jsx)(F.O,{element:E.Od.create({style:E.Od.SkeletonStyle.ELEMENT})}):(0,I.jsx)(t,{...this.props,mapboxToken:i,width:n})},this.state={isFetching:!0,mapboxToken:void 0,mapboxTokenError:void 0}}componentDidMount(){const e=this.props.element.mapboxToken||this.context.libConfig.mapboxToken;e?this.setState({mapboxToken:e,isFetching:!1}):this.initMapboxToken()}}return i.displayName=`withMapboxToken(${t.displayName||t.name})`,i.contextType=V.E,T()(i,t)};var L=i(83405);const H=(0,L.Z)("div",{target:"e1az0zs51"})((e=>{let{width:t,height:i,theme:o}=e;return{marginTop:o.spacing.sm,position:"relative",height:i,width:t}}),""),N=(0,L.Z)("div",{target:"e1az0zs50"})((e=>{let{theme:t}=e;return{position:"absolute",right:"2.625rem",top:t.spacing.md,zIndex:1,"button:not(:disabled)":{background:t.colors.bgColor,"& + button":{borderTopColor:t.colors.secondaryBg},"& span":{filter:(0,f.Iy)(t)?"":"invert(100%)"}}}}),"");i(12815);const $={classes:{...u,...w,...x,...b,CartoLayer:d.Z},functions:{colorBins:c.Z,colorCategories:p.Z,colorContinuous:m.Z}};(0,v.fh)([y.w,S.E]);const B=new g.Z({configuration:$});class R extends o.PureComponent{constructor(){super(...arguments),this.state={viewState:{bearing:0,pitch:0,zoom:11},initialized:!1,initialViewState:{},id:void 0,pydeckJson:void 0,isFullScreen:!1,isLightTheme:(0,f.Iy)(this.props.theme)},this.componentDidMount=()=>{this.setState({initialized:!0})},this.createTooltip=e=>{const{element:t}=this.props;if(!e||!e.object||!t.tooltip)return!1;const i=n.Z.parse(t.tooltip);return i.html?i.html=this.interpolate(e,i.html):i.text=this.interpolate(e,i.text),i},this.interpolate=(e,t)=>{const i=t.match(/{(.*?)}/g);return i&&i.forEach((i=>{const o=i.substring(1,i.length-1);e.object.hasOwnProperty(o)?t=t.replace(i,e.object[o]):e.object.hasOwnProperty("properties")&&e.object.properties.hasOwnProperty(o)&&(t=t.replace(i,e.object.properties[o]))})),t},this.onViewStateChange=e=>{let{viewState:t}=e;this.setState({viewState:t})}}static getDerivedStateFromProps(e,t){const i=R.getDeckObject(e,t);if(!a()(i.initialViewState,t.initialViewState)){const e=Object.keys(i.initialViewState).reduce(((e,o)=>i.initialViewState[o]===t.initialViewState[o]?e:{...e,[o]:i.initialViewState[o]}),{});return{viewState:{...t.viewState,...e},initialViewState:i.initialViewState}}return null}render(){const e=R.getDeckObject(this.props,this.state),{viewState:t}=this.state,{width:i}=this.props;return(0,I.jsx)(H,{className:"stDeckGlJsonChart","data-testid":"stDeckGlJsonChart",width:i,height:e.initialViewState.height,children:(0,I.jsxs)(s.Z,{viewState:t,onViewStateChange:this.onViewStateChange,height:e.initialViewState.height,width:i,layers:this.state.initialized?e.layers:[],getTooltip:this.createTooltip,ContextProvider:l.X$.Provider,controller:!0,children:[(0,I.jsx)(l.Z3,{height:e.initialViewState.height,width:i,mapStyle:e.mapStyle&&("string"===typeof e.mapStyle?e.mapStyle:e.mapStyle[0]),mapboxApiAccessToken:this.props.element.mapboxToken||this.props.mapboxToken}),(0,I.jsx)(N,{children:(0,I.jsx)(l.Pv,{"data-testid":"stDeckGlJsonChartZoomButton",showCompass:!1})})]})})}}R.getDeckObject=(e,t)=>{var i,o;const{element:s,width:r,height:a,theme:l,isFullScreen:h}=e,d=null!==h&&void 0!==h&&h;var c,p,m;(s.id===t.id&&t.isFullScreen===d&&t.isLightTheme===(0,f.Iy)(l)||(t.pydeckJson=n.Z.parse(s.json),t.id=s.id),null!==(i=t.pydeckJson)&&void 0!==i&&i.mapStyle||(t.pydeckJson.mapStyle=`mapbox://styles/mapbox/${(0,f.Iy)(l)?"light":"dark"}-v9`),h)?Object.assign(null===(c=t.pydeckJson)||void 0===c?void 0:c.initialViewState,{width:r,height:a}):(null!==(p=t.pydeckJson)&&void 0!==p&&null!==(m=p.initialViewState)&&void 0!==m&&m.height||(t.pydeckJson.initialViewState.height=500),s.useContainerWidth&&(t.pydeckJson.initialViewState.width=r));return t.isFullScreen=h,t.isLightTheme=(0,f.Iy)(l),null===(o=t.pydeckJson)||void 0===o||delete o.views,B.convert(t.pydeckJson)};const G=(0,h.b)(W("st.pydeck_chart")((0,k.Z)(R)))},2313:(e,t,i)=>{i.d(t,{Z:()=>w});var o=i(30969),s=i(47814),n=i.n(s),r=i(3077),a=i(63973),l=i(50797),h=i(77746),d=i(64756),c=i(83405);const p=(0,c.Z)("button",{target:"e1vs0wn31"})((e=>{let{isExpanded:t,theme:i}=e;const o=t?{right:"0.4rem",top:"0.5rem",backgroundColor:"transparent"}:{right:"-3.0rem",top:"-0.375rem",opacity:0,transform:"scale(0)",backgroundColor:i.colors.lightenedBg05};return{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",zIndex:i.zIndices.sidebar+1,height:"2.5rem",width:"2.5rem",transition:"opacity 300ms 150ms, transform 300ms 150ms",border:"none",color:i.colors.fadedText60,borderRadius:"50%",...o,"&:focus":{outline:"none"},"&:active, &:focus-visible, &:hover":{opacity:1,outline:"none",transform:"scale(1)",color:i.colors.bodyText,transition:"none"}}}),""),m=(0,c.Z)("div",{target:"e1vs0wn30"})((e=>{let{theme:t,isExpanded:i}=e;return{"&:hover":{[p]:{opacity:1,transform:"scale(1)",transition:"none"}},...i?{position:"fixed",top:0,left:0,bottom:0,right:0,background:t.colors.bgColor,zIndex:t.zIndices.fullscreenWrapper,padding:t.spacing.md,paddingTop:t.sizes.fullScreenHeaderHeight,overflow:["auto","overlay"],display:"flex",alignItems:"center",justifyContent:"center"}:{}}}),"");var u=i(37574);class g extends o.PureComponent{constructor(e){super(e),this.context=void 0,this.controlKeys=e=>{const{expanded:t}=this.state;27===e.keyCode&&t&&this.zoomOut()},this.zoomIn=()=>{document.body.style.overflow="hidden",this.context.setFullScreen(!0),this.setState({expanded:!0})},this.zoomOut=()=>{document.body.style.overflow="unset",this.context.setFullScreen(!1),this.setState({expanded:!1})},this.convertScssRemValueToPixels=e=>parseFloat(e)*parseFloat(getComputedStyle(document.documentElement).fontSize),this.getWindowDimensions=()=>{const e=this.convertScssRemValueToPixels(this.props.theme.spacing.md),t=this.convertScssRemValueToPixels(this.props.theme.sizes.fullScreenHeaderHeight);return{fullWidth:window.innerWidth-2*e,fullHeight:window.innerHeight-(e+t)}},this.updateWindowDimensions=()=>{this.setState(this.getWindowDimensions())},this.state={expanded:!1,...this.getWindowDimensions()}}componentDidMount(){window.addEventListener("resize",this.updateWindowDimensions),document.addEventListener("keydown",this.controlKeys,!1)}componentWillUnmount(){window.removeEventListener("resize",this.updateWindowDimensions),document.removeEventListener("keydown",this.controlKeys,!1)}render(){const{expanded:e,fullWidth:t,fullHeight:i}=this.state,{children:o,width:s,height:n,disableFullscreenMode:r}=this.props;let d=a.d,c=this.zoomIn,g="View fullscreen";return e&&(d=l.m,c=this.zoomOut,g="Exit fullscreen"),(0,u.jsxs)(m,{isExpanded:e,"data-testid":"stFullScreenFrame",children:[!r&&(0,u.jsx)(p,{"data-testid":"StyledFullScreenButton",onClick:c,title:g,isExpanded:e,children:(0,u.jsx)(h.Z,{content:d})}),o(e?{width:t,height:i,expanded:e,expand:this.zoomIn,collapse:this.zoomOut}:{width:s,height:n,expanded:e,expand:this.zoomIn,collapse:this.zoomOut})]})}}g.contextType=d.E;const x=(0,r.b)(g);const w=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];class i extends o.PureComponent{constructor(){super(...arguments),this.render=()=>{const{width:i,height:o,disableFullscreenMode:s}=this.props;return(0,u.jsx)(x,{width:i,height:o,disableFullscreenMode:t||s,children:t=>{let{width:i,height:o,expanded:s,expand:n,collapse:r}=t;return(0,u.jsx)(e,{...this.props,width:i,height:o,isFullScreen:s,expand:n,collapse:r})}})}}}return i.displayName=`withFullScreenWrapper(${e.displayName||e.name})`,n()(i,e)}}}]);
//# sourceMappingURL=3808.27bc6ede.chunk.js.map